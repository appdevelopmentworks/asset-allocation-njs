# 要求定義書 - Asset Allocation Tool (Next.js版)

## 1. プロジェクト概要

### 1.1 プロジェクト名
Asset Allocation Tool - Modern Portfolio Optimizer

### 1.2 目的
投資家が複数の資産クラスにわたってポートフォリオを最適化し、リスクとリターンのバランスを視覚的に理解できるWebアプリケーションを提供する。

### 1.3 背景
- 既存のStreamlit版アプリケーションの機能をベースに、より高速でモダンなUXを提供
- モバイルファーストのレスポンシブデザインで、あらゆるデバイスから利用可能
- リアルタイムデータ更新とインタラクティブな視覚化

## 2. ステークホルダー

### 2.1 主要ユーザー
- **個人投資家**: ポートフォリオ最適化を行いたい一般投資家
- **投資アドバイザー**: クライアント向けにポートフォリオ提案を作成
- **金融教育者**: 投資理論の教育ツールとして使用
- **学生・研究者**: 現代ポートフォリオ理論の学習・研究

### 2.2 システム管理者
- アプリケーション開発者
- デプロイメント管理者（Vercel）

## 3. 機能要求

### 3.1 必須機能（Must Have）

#### 3.1.1 データ取得機能
- Yahoo Finance APIからのリアルタイムデータ取得
- 複数資産（株式、ETF、債券、コモディティ、暗号通貨）対応
- 指定期間の履歴データ取得（最低1年、最大20年）
- データキャッシング（API制限対策）

#### 3.1.2 ポートフォリオ分析機能
- 効率的フロンティアの計算と可視化
- モンテカルロシミュレーション（1,000～10,000回）
- 最適ポートフォリオの計算
  - 最大シャープレシオ
  - 最小分散
  - 最大リターン
- リスク・リターン分析
- 相関マトリックス分析

#### 3.1.3 ユーザーインターフェース
- 資産選択機能
  - プリセットポートフォリオ（バランス型、保守的、アグレッシブ等）
  - カスタム資産入力
  - 検索・サジェスト機能
- 期間選択（カレンダー UI）
- 初期投資額設定
- シミュレーション回数設定

#### 3.1.4 可視化機能
- 価格推移チャート（正規化）
- 効率的フロンティア散布図
- ポートフォリオ配分円グラフ
- 相関マトリックスヒートマップ
- パフォーマンス指標カード

### 3.2 重要機能（Should Have）

#### 3.2.1 ポートフォリオ管理
- ポートフォリオの保存機能（ローカルストレージ）
- 複数ポートフォリオの比較
- ポートフォリオのエクスポート（CSV/JSON）
- URLによるポートフォリオ共有

#### 3.2.2 高度な分析
- バックテスト機能
- リバランス提案
- ドローダウン分析
- VaR（Value at Risk）計算
- 条件付きVaR（CVaR）

#### 3.2.3 アラート・通知
- ポートフォリオパフォーマンスアラート
- 相関関係の変化通知
- リバランス推奨通知

### 3.3 あれば良い機能（Nice to Have）

#### 3.3.1 カスタマイゼーション
- ダークモード/ライトモード切替
- チャートテーマのカスタマイズ
- 言語切替（日本語/英語）
- カスタム指標の追加

#### 3.3.2 ソーシャル機能
- ポートフォリオのソーシャル共有
- コミュニティ投稿機能
- 人気ポートフォリオランキング

#### 3.3.3 AI機能
- AIによるポートフォリオ提案
- 市場センチメント分析
- ニュースインパクト分析

## 4. 非機能要求

### 4.1 パフォーマンス要求
- **ページロード時間**: 初回3秒以内、2回目以降1秒以内
- **API レスポンス**: 2秒以内
- **チャート描画**: 1秒以内
- **同時接続数**: 最低100ユーザー

### 4.2 使いやすさ要求
- **レスポンシブデザイン**: モバイル、タブレット、デスクトップ対応
- **ブラウザ対応**: Chrome、Safari、Firefox、Edge（最新2バージョン）
- **アクセシビリティ**: WCAG 2.1 Level AA準拠
- **多言語対応**: 日本語、英語（初期リリースは日本語）

### 4.3 信頼性要求
- **可用性**: 99.9%（月間ダウンタイム43分以内）
- **データ正確性**: Yahoo Finance APIの精度に準拠
- **エラーハンドリング**: すべてのエラーに対する適切なメッセージ表示
- **データバックアップ**: ユーザー設定の自動バックアップ

### 4.4 セキュリティ要求
- **HTTPS通信**: すべての通信をSSL/TLS暗号化
- **認証**: オプション（将来的にAuth0/Firebase Auth実装）
- **データ保護**: 個人情報の暗号化保存
- **CSP**: Content Security Policy実装
- **XSS/CSRF対策**: 適切なサニタイゼーション

### 4.5 保守性要求
- **コード品質**: ESLint/Prettier準拠
- **テストカバレッジ**: 80%以上
- **ドキュメント**: APIドキュメント、コンポーネントストーリーブック
- **CI/CD**: GitHub Actions + Vercel自動デプロイ

## 5. 制約条件

### 5.1 技術制約
- **フレームワーク**: Next.js 15 (App Router)
- **スタイリング**: TailwindCSS + shadcn/ui
- **アニメーション**: Framer Motion
- **デプロイ**: Vercel
- **データソース**: Yahoo Finance API（無料版制限あり）

### 5.2 ビジネス制約
- **開発期間**: 4週間
- **予算**: 無料枠内での運用
- **ライセンス**: MITライセンス（オープンソース）

### 5.3 規制制約
- **金融規制**: 投資助言業に該当しない範囲での情報提供
- **免責事項**: 投資判断の責任に関する明確な記載
- **個人情報保護**: GDPR/個人情報保護法準拠

## 6. 成功指標（KPI）

### 6.1 定量的指標
- **月間アクティブユーザー（MAU）**: 1,000人以上
- **平均セッション時間**: 5分以上
- **ページビュー/セッション**: 3ページ以上
- **直帰率**: 40%以下
- **Core Web Vitals**: すべて「良好」評価

### 6.2 定性的指標
- ユーザー満足度（NPS）: 40以上
- UIの直感性
- 分析結果の理解しやすさ
- モバイル体験の品質

## 7. リスクと対策

### 7.1 技術的リスク
| リスク | 影響度 | 発生可能性 | 対策 |
|-------|-------|----------|------|
| Yahoo Finance API制限 | 高 | 中 | キャッシング実装、複数APIソース検討 |
| パフォーマンス低下 | 中 | 低 | CDN利用、コード最適化 |
| ブラウザ互換性問題 | 低 | 低 | Polyfill使用、十分なテスト |

### 7.2 ビジネスリスク
| リスク | 影響度 | 発生可能性 | 対策 |
|-------|-------|----------|------|
| 競合サービスの出現 | 中 | 高 | 差別化機能の継続開発 |
| 規制変更 | 高 | 低 | 免責事項の明記、法的レビュー |
| ユーザー獲得困難 | 中 | 中 | SEO対策、コンテンツマーケティング |

## 8. 今後の拡張計画

### Phase 2 (3ヶ月後)
- ユーザー認証・アカウント機能
- ポートフォリオ履歴管理
- バックテスト機能強化

### Phase 3 (6ヶ月後)
- AI駆動の投資提案
- リアルタイム市場データ
- モバイルアプリ開発

### Phase 4 (1年後)
- 取引API連携
- 自動リバランス機能
- 機関投資家向け機能

## 9. 承認

| 役割 | 氏名 | 承認日 | 署名 |
|-----|------|-------|------|
| プロジェクトオーナー | - | - | - |
| 開発リード | - | - | - |
| UXデザイナー | - | - | - |

---
*最終更新日: 2024年12月*
*バージョン: 1.0.0*
