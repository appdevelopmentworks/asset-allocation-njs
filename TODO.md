# 開発TODOリスト

次回以降も迷わず進められるよう、現状の対応状況を整理しました。

1. **[完了] 実アプリへの最適化結果連携**
   - `/dashboard/portfolio` で `useOptimization` が現在のポートフォリオをAPIへ送信し、レスポンスをテーブル/チャートへ反映する実装を完了。

2. **[完了] CIワークフローの強化**
   - lint / type-check / test の並列ジョブ化や `pnpm` キャッシュ設定を整備済み。必要に応じたArtifacts収集も実装済み。

3. **[完了] 最適化ロジックのUI結合テスト**
   - `src/tests/unit/app/dashboard/portfolio-page.test.tsx` を追加し、React Testing Library で戦略切替・i18n表示・チャート/テーブルの動作を自動検証。

4. **[完了] API入力の拡張**
   - `/api/optimization` がPOSTでクライアントのポートフォリオを受け取り、戦略バリデーションと正規化を経て最適化結果を返すよう変更。

5. **[完了] 実データ連携とバリデーション強化の下準備**
   - `getOptimizationSummaries` を市場データプロバイダ経由にし、キャッシュ層付きの抽象化を実装。外部APIが落ちてもシミュレーテッドデータへフェイルオーバーする。
   - リクエストレンジ（`Portfolio.settings.timeRange`）に応じた期間を使い、メタ情報としてデータソース/キャッシュ利用有無を返却。

6. **[完了] UX改善とアクセシビリティ**
   - 最適化セクションにローディング/エラーのステータステキストと `aria-live` を追加し、再取得ボタンでフェッチをリトライできるようにした。

7. **次のステップ: 実API接続とUIブラッシュアップ**
   - Yahoo Finance など実データプロバイダを `MarketDataProvider` 実装として追加し、環境変数でAPIキーを注入する。
   - ポートフォリオ最適化結果のソース表示（キャッシュ/外部/シミュレーション）をカードUIに明示し、チャート類にもローディングスケルトンを導入する。

8. **[完了] UIグラススタイルの統一**
   - ホームヒーローとダッシュボード/ポートフォリオのメトリクスカードをグレイ系グラスに統一。
   - ポートフォリオ情報・シミュレーション設定フォーム、シミュレーションスナップショットにも同質感を適用。

このリストをもとに、次フェーズのタスク化や優先度調整を進めてください。
